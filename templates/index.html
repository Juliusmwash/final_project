<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Cropper -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css"/>
		<!-- google fonts -->
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Whisper&display=swap" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css2?family=Baskervville&display=swap" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css2?family=Cinzel&display=swap" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css2?family=Cormorant&display=swap" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css2?family=Gruppo&display=swap" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css2?family=Beau+Rivage&display=swap" rel="stylesheet">
		<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lobster&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap">
		<link href="https://fonts.googleapis.com/css2?family=Kalnia&display=swap" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@200;300;400;500;600;700&display=swap" rel="stylesheet">
		<!-- MathJax -->
		<script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Stylesheet -->
    <link rel="stylesheet" href="../static/css/image_style.css" />
    <link rel="stylesheet" href="../static/css/index.css">
		<link rel="stylesheet" href="../static/css/index-pdf-download.css">
		<!--<link rel="stylesheet" href="../static/css/decide.css">-->
    <link rel="stylesheet" href="../static/css/page_loader.css">
		<link rel="stylesheet" href="../static/css/content_share.css">
    <title>ZMC STUDENT ASSISTANT</title>
    <style>
    </style>
</head>
<body>
		<div id="blur-div"></div>
    <header>
				<div class="token-label">tokens</div>
				<div class="tokens-counter">0</div>
				<div class="signout-status">Sign-out</div>
        <h2 class="h2-header">ZMC STUDENT ASSISTANT</h2>

					<!-- Share section -->
						<div class="share-container">

							<div class="share-loading-box1" style="display: none;">
								<div id="share-load-tmp-holder1">Please Wait</div>
								<div class="share-loading-dots1">
									<span class="share-loading-dot1"></span>
									<span class="share-loading-dot1"></span>
									<span class="share-loading-dot1"></span>
								</div>

							</div>
							<div class="share-cancel-btn">Cancel</div>
							<div class="landing-buttons">
								<div class="share-content-button">Share Content</div>
								<div class="get-content-button">Get Content</div>
							</div>

							<div class="share-wrapper-send" style="display: none;">
								<div class="response-info" style="display: none;">response info to user</div>
								<label class="share-label" for="content-title">Suitable Title (Max 20 characters):</label>
						    <input type="text" id="content-title" maxlength="20" placeholder="Give your content a suitable title.">

						    <label class="share-label" for="description">Description (Max 300 characters)</label>
						    <textarea id="description" maxlength="300" placeholder="Share the motivation behind presenting this content to fellow students. Clearly convey the essence of the material, whether it's unraveling a complex algebraic equation or overcoming a challenging mathematical problem. Illuminate the significance of the content to foster understanding among your peers."></textarea>

					    <label class="share-label" for="taggedEmails">Target Email Addresses (Optional)</label>
					    <textarea id="taggedEmails" placeholder="Separate the addresses using spaces. This resource will trigger notifications for each recipient. It will also be available for other students to check as well."></textarea>

					    <div class="share-info">Only the content of this thread will be shared.</div>
							<div class="confirm-share-box">
								<div class="share-button">Share</div>
							</div>
						</div>

						<div class="share-wrapper-receive">
							<div class="receive-choice-box" style="display: none;">
								<div class="have-share-id">Use Share Id</div>
								<div class="random-shared-threads">Random Ten</div>
							</div>
							<div class="use-share-id-box" style="display: none;">
								<div class="share-loading-box" style="display: none;">
									<div id="share-load-tmp-holder">Getting Content</div>
									<div class="share-loading-dots">
										<span class="share-loading-dot"></span>
										<span class="share-loading-dot"></span>
										<span class="share-loading-dot"></span>
									</div>
								</div>

								<label class="share-label" for="use-share-id">Share Id</label>
								<input class="share-id-input" type="text" id="content-title" maxlength="12" placeholder="Enter the Share Id" required>
								<div class="get-content">Get Content</div>
							</div>
							<div class="random-ten-box" style="display: none;">
								<!-- <span class="random-ten-content"></span> -->
							</div>
						</div>
					</div>
					<!-- Share section end -->

    </header>
		<span id="thread-id-holder" style="display: none;"></span>




		<section class="generator-section">
        <div class="generator-container">
					<div class="loading-box2" style="display: none;">
						<div id="load-tmp-holder2" style="display: flex;">Just a moment, creating a new thread&nbsp;</div>
						<div class="loading-dots2">
							<span class="loading-dot2"></span>
							<span class="loading-dot2"></span>
							<span class="loading-dot2"></span>
						</div>
					</div>



				<div id="fixed-div">
					<!-- Threads selection section -->
					<div id="request-new-thread">new thread</div>
					<!-- font change -->
					<div id="change-font-btn">font</div>
					<div class="font-dropdown-box" style="display: none;">
						<div class="font-dropdown">Roboto</div>
						<div class="font-dropdown">Lobster</div>
						<div class="font-dropdown">Open Sans</div>
						<div class="font-dropdown">Poppins</div>
						<div class="font-dropdown">Whisper</div>
						<div class="font-dropdown">Beau Revage</div>
						<div class="font-dropdown">Cinzel</div>
						<div class="font-dropdown">Cormorant</div>
						<div class="font-dropdown">Gruppo</div>
						<div class="font-dropdown">Baskervville</div>
					</div>


					<div class="confirm-new-thread">
						<span class="accept-label">Create a new thread?</span>
						<div class="confirm-new-thread-btns">
							<span class="accept-btn">Yes</span>
							<span class="decline-btn">No</span>
						</div>
					</div>


					<div id="change-other-btn">other</div>
					<div class="font-size-box" style="display: none;">
						<div class="program-info-btn">program info</div>
						<div class="font-size-box-btn">font size</div>
						<div id="change-color-btn">text color</div>
						<div id="change-background-btn">background</div>
						<div class="user-styling-button">save my styles</div>
						<div class="reveal-share-box-button">content sharing</div>
						<div class="download-pdf-button">download pdf</div>
					</div>


					<div class="appearing-box">
						<div class="font-counter">14</div>
						<div class="incre-decre-box">
							<div class="decrement">-</div>
							<div class="increment">+</div>
						</div>
						<div class="okay">ok</div>
					</div>



					<!-- pdf download section -->
					<div class="pdf-download-container">
						<div class="pdf-loading-box" style="display: none;">
							<div id="pdf-load-tmp-holder" style="display: flex;">please wait, don't exit</div>
							<div class="pdf-loading-dots">
								<span class="pdf-loading-dot"></span>
								<span class="pdf-loading-dot"></span>
								<span class="pdf-loading-dot"></span>
							</div>
						</div>

						<div class="download-box">
							<form action="/generate_pdf_route" method="POST" id="default-pdf-form">
								<input type="hidden" name="default_pdf" value="okay"/>
							</form>
							<button class="pdf-download-btn" type="submit" id="download-btn">download</button>
							<button class="pdf-download-btn"  id="advanced-btn">advanced</button>
						</div>
						<div class="advanced-box" style="display: none;">
							<form action="/generate_pdf_route" method="POST" id="custom-pdf-form">
								<label class="pdf-input-label">letter spacing</label>
								<input type="number" class="pdf-input" name="letter_spacing">

								<label class="pdf-input-label">font size</label>
								<input type="number" class="pdf-input" name="font_size">

								<label class="pdf-input-label">page margins</label>
								<input type="number" class="pdf-input" name="page_margins">

								<label class="pdf-input-label">background color</label>
								<input type="text" class="pdf-input" name="background_color">

								<label class="pdf-input-label">text colour</label>
								<input type="text" class="pdf-input" name="text_color">
							</form>
							<button class="pdf-download-btn" type="submit" id="download-advanced-btn">download</button>
						</div>
						<button type="button" id="pdf-exit-btn">exit</button>
					</div>
					<!-- pdf download sectiom end -->











					<!-- colour changer -->
					<div class="color-dropdown-box">
						<div class="exit-color-dropdown">Exit</div>
						<div class="color-dropdown" style="color: black; background-color: #F0F8FF;" data-color-code="#F0F8FF">#F0F8FF</div>
						<div class="color-dropdown" style="color: black; background-color: #FAEBD7;" data-color-code="#FAEBD7">#FAEBD7</div>
						<div class="color-dropdown" style="color: black; background-color: #00FFFF;" data-color-code="#00FFD4">#00FFD4</div>
						<div class="color-dropdown" style="color: black; background-color: #7FFFD4;" data-color-code="#7FFFD4">#7FFFD4</div>
						<div class="color-dropdown" style="color: black; background-color: #8A2BE2;" data-color-code="#8A2BE2">#8A2BE2</div>
						<div class="color-dropdown" style="color: black; background-color: #FF7F50;" data-color-code="#FF7F50">#FF7F50</div>
						<div class="color-dropdown" style="color: black; background-color: #6495ED;" data-color-code="#6495ED">#6595ED</div>
						<div class="color-dropdown" style="color: black; background-color: #B8860B;" data-color-code="#B8860B">#B8860B</div>
						<div class="color-dropdown" style="color: black; background-color: #A9A9A9;" data-color-code="#A9A9A9">#A9A9A9</div>
						<div class="color-dropdown" style="color: black; background-color: #BDB76B;" data-color-code="#BDB76B">#BDB76B</div>
						<div class="color-dropdown" style="color: black; background-color: #FF8C00;" data-color-code="#FF8C00">#FF8C00</div>
						<div class="color-dropdown" style="color: black; background-color: #8FBC8F;" data-color-code="#8FBC8F">#8FBC8F</div>
						<div class="color-dropdown" style="color: black; background-color: #00CED1;" data-color-code="#00CED1">#00CED1</div>
						<div class="color-dropdown" style="color: black; background-color: #FF1493;" data-color-code="#FF1493">#FF1493</div>
						<div class="color-dropdown" style="color: black; background-color: #FFD700;" data-color-code="#FFD700">#FFD700</div>
						<div class="color-dropdown" style="color: black; background-color: #FFB6C1;" data-color-code="#FFB6C1">#FFB6C1</div>
						<div class="color-dropdown" style="color: black; background-color: 20B2AA;" data-color-code="#20B2AA">#20B2AA</div>
						<div class="color-dropdown" style="color: black; background-color: #00FA9A;" data-color-code="#00FA9A">#00FA9A</div>
						<div class="color-dropdown" style="color: black; background-color: #DA70D6;" data-color-code="#DA70D6">#DA70D6</div>
						<div class="color-dropdown" style="color: black; background-color: #40E0D0;" data-color-code="#40E0D0">#40E0D0</div>
						<div class="color-dropdown" style="color: black; background-color: #9ACD32;" data-color-code="#9ACD32">#9ACD32</div>
					</div>


					<div class="background-dropdown-box">
						<div class="exit-background-dropdown">Exit</div>
						<div class="background-dropdown" style="color: black; background-color: #253529;" data-background-code="#253529">#253529</div>
						<div class="background-dropdown" style="color: black; background-color: #3B3C36;" data-background-code="#3b3c36">#3b3c36</div>
						<div class="background-dropdown" style="color: black; background-color: #414A4C;" data-background-code="#414a4c">#414a4c</div>
						<div class="background-dropdown" style="color: black; background-color: #232B2B;" data-background-code="#232b2b">#232b2b</div>
						<div class="background-dropdown" style="color: black; background-color: #123524;" data-background-code="#123524">#123524</div>
						<div class="background-dropdown" style="color: black; background-color: #1A2421;" data-background-code="#1a2421">#1a2421</div>
						<div class="background-dropdown" style="color: black; background-color: #674846;" data-background-code="#675846">#675846</div>
						<div class="background-dropdown" style="color: black; background-color: #704241;" data-background-code="#704241">#704241</div>
						<div class="background-dropdown" style="color: black; background-color: #000036;" data-background-code="#000036">#000036</div>
						<div class="background-dropdown" style="color: black; background-color: #000039;" data-background-code="#000039">#000039</div>
						<div class="background-dropdown" style="color: black; background-color: #253529;" data-background-code="#253529">#253529</div>
						<div class="background-dropdown" style="color: black; background-color: #32174d;" data-background-code="#32174d">#32174d</div>
						<div class="background-dropdown" style="color: black; background-color: #100C08;" data-background-code="#100C08">#100C08</div>
						<div class="background-dropdown" style="color: black; background-color: #080808;" data-background-code="#080808">#080808</div>
						<div class="background-dropdown" style="color: black; background-color: #1c2841;" data-background-code="#1c2841">#1c2841</div>
						<div class="background-dropdown" style="color: black; background-color: #480607;" data-background-code="#480607">#480607</div>
						<div class="background-dropdown" style="color: black; background-color: #010127;" data-background-code="#010127">#010127</div>
						<div class="background-dropdown" style="color: black; background-color: #151922;" data-background-code="#151922">#151922</div>
						<div class="background-dropdown" style="color: black; background-color: #004242;" data-background-code="#004242">#004242</div>
					</div>


					<div id="thread-selector">threads</div>
					<div class="thread-dropdown-box" style="display: none;">
						<div class="thread-dropdown">1</div>
						<div class="thread-dropdown">2</div>
						<div class="thread-dropdown">3</div>
					</div>
				</div>

					<div class="generator-prompt">
						<!-- -->
						<div class="loading-box">
							<div id="load-tmp-holder" style="display: flex;">Just a moment, I'm working on it&nbsp;</div>
							<div class="loading-dots">
                <span class="loading-dot"></span>
								<span class="loading-dot"></span>
								<span class="loading-dot"></span>
							</div>
						</div>
						<div class="text-area-box">
							<textarea id="text-area" placeholder="Enter your query here"></textarea>
						</div>
						<div id="send-text-prompt-bx">
							<div id="text-prompt-btn">send</div>
						</div>

						<div id="sep-or">OR</div>
						<div class="wrapper">
							<div class="container">
                <div class="image-container">
                  <img id="image" />
                </div>
								<div class="preview-container">
									<img id="preview-image" />
								</div>
							</div>


							<input type="file" id="file" accept="image/*" />
							<label id="choose-a-photo" for="file">Choose A Photo</label>
							<div class="option-wrapper" style="display: none;">
								<div class="options hide">
									<button class="aspect-ratio-button">16:9</button>
									<button class="aspect-ratio-button">4:3</button>
									<button class="aspect-ratio-button">1:1</button>
									<button class="aspect-ratio-button">2:3</button>
									<button class="aspect-ratio-button">Free</button>
								</div>
							</div>
							<div class="btns">
								<button id="preview" class="btnBtn hide">Preview</button>
								<a href="/image_data" id="download" class="btnBtn hide">Use</a>
							</div>
						</div>
						<!-- -->
					</div>





            <div class="star-container-main" style="display: none;">
                <div class="cont-box">
                    <div class="loading-container" id="loadingContainer">
                        <div class="loading-spinner">
                        </div>
                    </div>
                    <div class="star-container" id="starContainer">
                        <div class="rotating-star"></div>
                    </div>
                </div>
            </div>
						<a href="/logout" id="logout-btn" style="display: none;"></a>
            <div class="generator-box" style="display: block;">
							<p>Welcome to <span style="color: lime;">ZMC Student Assistant!</span> I'm here to enhance your understanding of various subjects.</p>
							<!-- <p>Proper use can lead to <span style="color: orange;">academic success</span>, but <span style="color: #FF0000;">misusing</span> me as a mere shortcut may hinder your career.</p><p>I encourage you to engage with the content I provide for <span style="color: lime;">optimal educational benefits</span>.</p><p>Feel free to ask questions on any subject, and I'll help you grasp the concepts. <span style="color: lime;">Use me wisely</span>, and I'll contribute to your educational journey positively.</p><p>Remember, success in your studies comes from active learning. <span style="color: orange;">Don't just seek quick answers</span>; take the time to comprehend the material.</p><p>Utilize me as a resource for <span style="color: lime;">clarification</span> and <span style="color: lime;">"deeper understanding</span> rather than a <span style="color: #FF0000;">shortcut for assignments</span>.</p><p>Your education is a valuable investment, and thoughtful use of this assistant can significantly impact your academic growth.</p><p>Happy learning!</p>> --> 

            </div>
        </div>
    </section>
    <footer>
        <p class="copyright" style="display: none;">&copy; 2023 ZMC Student Assistant</p>
    </footer>
    <script>
			// Get the data threads sequence from the server
			const tokensCount = {{ tokens_count | tojson | safe }};
			const obj = {{ obj | tojson | safe }};
			const userStyling = {{ user_styling | tojson | safe }};
			const threadIdentity = {{ thread_id | tojson | safe }};

			// Set some global variables
			let fontSize = 14;
			let choiceColor;
			let fontFamily = "Gruppo";
			let choiceBackground;
			const threadsDataSequence = obj.threads;


			document.addEventListener('DOMContentLoaded', async () => {
			//alert(`obj = ${JSON.stringify(obj.response_text)}`);

			if (userStyling) {
        // Set values for the global variables
        fontSize = userStyling.font_size;
        fontFamily = userStyling.font_family;
        choiceColor = userStyling.text_color;
        choiceBackground = userStyling.background_color;
        await adjustToUserStyling();
      }

			if (threadIdentity) {
				// Save the thread id
				const threadIdHolder = document.getElementById('thread-id-holder');
				threadIdHolder.textContent = threadIdentity;
			}

			/*async function loadGeneratorElementData(obj) {
				if (obj && obj.success) {
					const generatorBox = document.querySelector('.generator-box');
					// Replace all occurrences of "&bksl;" with a backslash
					const inputString = obj.response_text;
					const outputString = inputString.replace(/&bksl;/g, "\\");
					generatorBox.innerHTML = outputString;
					await adjustToUserStyling();
				}
			}*/


			async function adjustToUserStyling() {
				// Reset font styles
				const elementsToStyle = ['p', 'ul', 'li', 'span', '.generator-box'];
				elementsToStyle.forEach((selector) => {
				  const elements = document.querySelectorAll(selector);
				  elements.forEach((element) => {
				    element.style.fontFamily = fontFamily;
				    element.style.fontSize = fontSize + "px";
				    if (selector === 'p') {
				      if (choiceColor) {
				        element.style.color = choiceColor;
				      }
						} else if (selector === '.generator-box') {
							element.style.fontSize = fontSize;
							element.style.color = choiceColor;
							element.style.backgroundColor = choiceBackground;
						}
				  });
				});
			}

			// Update tokens div element
			const tokensCounter = document.querySelector('.tokens-counter');
			if (tokensCounter) {
				tokensCounter.textContent = tokensCount;
				//if (parseInt(data.tokens_count) <= 1000) {
				if (tokensCount <= 5000) {
					tokensCounter.style.color = "#FF0000";
				}
			} else {
				tokensCounter.textContent = 0;
			}

			async function loadThreadInTheBox(obj) {
				const generatorBox = document.querySelector('.generator-box');

				// Replace all occurrences of "&bksl;" with a backslash
				const inputString = obj.response_text;
				const outputString = inputString.replace(/&bksl;/g, "\\");

				setTimeout(async () => {
					generatorBox.innerHTML = outputString;
					await adjustToUserStyling();
				}, 3000);
			}

			if (obj) {
				await loadThreadInTheBox(obj);
			}

      // Trigger MathJax rendering
      MathJax.typeset();
			});
    </script>
    <script src="../static/js/image_script.js"></script>
		<script src="../static/js/content_share.js"></script>
		<script src="../static/js/index-pdf-download.js"></script>
</body>
</html>

